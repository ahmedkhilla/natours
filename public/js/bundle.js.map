{"mappings":"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","sources":["public/js/index.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js","public/js/map.js"],"sourcesContent":["/* eslint-disable */\r\nimport { login, logout } from './login.js'\r\nimport { updateSettings } from './updateSettings.js';\r\nimport { bookTour } from './stripe.js';\r\nimport { displayMap } from './map.js';\r\n\r\nconst userDataForm = document.querySelector('.form-user-data');\r\nconst userPasswordForm = document.querySelector('.form-user-password');\r\nconst bookBtn = document.getElementById('book-tour');\r\nconst mapElement = document.getElementById('map');\r\n\r\nif (mapElement) {\r\n\tconst locationsData = JSON.parse(mapElement.dataset.locations);\r\n\tconst { startLocation, locations } = locationsData\r\n\tdisplayMap(startLocation, locations);\r\n}\r\n\r\nif (document.querySelector('.form--login'))\r\n\tdocument.querySelector('.form--login').addEventListener('submit', e => {\r\n\t\te.preventDefault();\r\n\t\t//const name = document.getElementById('name').value;\r\n\t\tconst email = document.getElementById('email').value;\r\n\t\tconst password = document.getElementById('password').value\r\n\t\t//updateSettings({ name, email }, 'data');\r\n\t\tlogin(email, password)\r\n\t});\r\n\r\nif (document.querySelector('.nav__el--logout'))\r\n\tdocument.querySelector('.nav__el--logout').addEventListener('click', logout);\r\n\r\n\r\nif (userDataForm)\r\n\tuserDataForm.addEventListener('submit', e => {\r\n\t\te.preventDefault();\r\n\t\tconst form = new FormData();\r\n\t\tform.append('name', document.getElementById('name').value);\r\n\t\tform.append('email', document.getElementById('email').value);\r\n\t\tform.append('photo', document.getElementById('photo').files[0]);\r\n\r\n\t\tupdateSettings(form, 'data');\r\n\t});\r\n\r\nif (userPasswordForm)\r\n\tuserPasswordForm.addEventListener('submit', async e => {\r\n\t\te.preventDefault();\r\n\t\tdocument.querySelector('.btn--save-password').textContent = 'Updating...';\r\n\r\n\t\tconst passwordCurrent = document.getElementById('password-current').value;\r\n\t\tconst password = document.getElementById('password').value;\r\n\t\tconst passwordConfirm = document.getElementById('password-confirm').value;\r\n\t\tawait updateSettings(\r\n\t\t\t{ passwordCurrent, password, passwordConfirm },\r\n\t\t\t'password'\r\n\t\t);\r\n\r\n\t\tdocument.querySelector('.btn--save-password').textContent = 'Save password';\r\n\t\tdocument.getElementById('password-current').value = '';\r\n\t\tdocument.getElementById('password').value = '';\r\n\t\tdocument.getElementById('password-confirm').value = '';\r\n\t});\r\n\r\nif (bookBtn)\r\n\tbookBtn.addEventListener('click', e => {\r\n\t\tconsole.log('clicked here');\r\n\t\te.target.textContent = 'Processing';\r\n\t\tconst { tourId } = e.target.dataset;\r\n\t\tbookTour(tourId)\r\n\t})","/* eslint-disable */\r\nimport { showAlert } from './alerts.js'\r\n\r\nexport const login = async (email, password) => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl: 'http://127.0.0.1:3000/api/v1/users/login',\r\n\t\t\tdata: {\r\n\t\t\t\temail,\r\n\t\t\t\tpassword\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (res.data.status === 'success') {\r\n\t\t\tshowAlert('success', 'Logged in successfully!');\r\n\t\t\tconsole.log('hey you successed');\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tlocation.assign('/');\r\n\t\t\t}, 1500);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tshowAlert('error', err.response.data.message);\r\n\t\tconsole.log(err);\r\n\t}\r\n};\r\n\r\nexport const logout = async () => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'GET',\r\n\t\t\turl: 'http://127.0.0.1:3000/api/v1/users/logout'\r\n\t\t});\r\n\t\tif ((res.data.status = 'success')) location.reload(true);\r\n\t} catch (err) {\r\n\t\tconsole.log(err.response);\r\n\t\tshowAlert('error', 'Error logging out! Try again.');\r\n\t}\r\n};\r\n\r\n","/* eslint-disable */\n\nconst hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","/* eslint-disable */\r\nimport { showAlert } from \"./alerts.js\";\r\n\r\nexport const updateSettings = async (data, type) => {\r\n\ttry {\r\n\t\tconst url =\r\n\t\t\ttype === 'password'\r\n\t\t\t\t? 'http://127.0.0.1:3000/api/v1/users/updateMyPassword'\r\n\t\t\t\t: 'http://127.0.0.1:3000/api/v1/users/updateMe';\r\n\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\turl,\r\n\t\t\tdata\r\n\t\t});\r\n\r\n\t\tif (res.data.status === 'success') {\r\n\t\t\tshowAlert('success', `${type.toUpperCase()} updated successfully!`);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tshowAlert('error', err.response.data.message);\r\n\t}\r\n};\r\n\r\n","/* eslint-disable */\r\nconst stripe = Stripe('pk_test_51RBxaIHJH8vBPo5TYWnLN7V5N6MHo5uImMovk6fMiVtzqUGSyVZzZTxmxSu9Jf1gZYkJsxKD2LLnaoL5CqSOTJjr00dT86MN1F');\r\n\r\nexport const bookTour = async tourId => {\r\n\ttry {\r\n\r\n\t\t// 1) Get checkout session from API\r\n\t\tconst session = await axios(`http://127.0.0.1:3000/api/v1/bookings/checkout-session/${tourId}`)\r\n\t\tconsole.log(session);\r\n\t\t// 2) Create checkout form + chanre credit card\r\n\t\tawait stripe.redirectToCheckout({\r\n\t\t\tsessionId: session.data.session.id\r\n\t\t})\r\n\t} catch (err) {\r\n\t\tconsole.log(err);\r\n\t\tshowAlert('error', err)\r\n\t}\r\n}\r\n\r\n\r\n","/* eslint-disable */\r\nexport const displayMap = (startLocation, locations) => {\r\n\tconsole.log(startLocation);\r\n\tconsole.log(locations, 'start');\r\n\tconst [lng, lat] = startLocation.coordinates;\r\n\tconsole.log(lat, lng, 'after');\r\n\tconst map = L.map('map', {\r\n\t\tzoomControl: false,\r\n\t\tscrollWheelZoom: false,\r\n\t}).setView([lat, lng], 13);\r\n\r\n\tL.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n\t\tattribution: '&copy; OpenStreetMap contributors'\r\n\t}).addTo(map);\r\n\r\n\tconst bounds = L.latLngBounds();\r\n\r\n\tlocations.forEach(loc => {\r\n\t\tconst [lng, lat] = loc.coordinates;\r\n\r\n\t\tconst marker = L.marker([lat, lng]).addTo(map);\r\n\t\tmarker.bindPopup(`<p>${loc.day ? `Day ${loc.day}: ` : ''}${loc.description}</p>`, {\r\n\t\t\tautoClose: false\r\n\t\t}).openPopup();\r\n\t\tbounds.extend(marker.getLatLng());\r\n\t});\r\n\tmap.fitBounds(bounds, { padding: [100, 100] })\r\n};"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../"}