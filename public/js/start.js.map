{"mappings":"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","sources":["<anon>","public/js/start.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js","public/js/map.js"],"sourcesContent":["(() => {\n/* eslint-disable */ /* eslint-disable */ /* eslint-disable */ const $e6adfa685459127e$var$hideAlert = ()=>{\n    const el = document.querySelector('.alert');\n    if (el) el.parentElement.removeChild(el);\n};\nconst $e6adfa685459127e$export$de026b00723010c1 = (type, msg)=>{\n    $e6adfa685459127e$var$hideAlert();\n    const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n    window.setTimeout($e6adfa685459127e$var$hideAlert, 5000);\n};\n\n\nconst $94464591c703bfdb$export$596d806903d1f59e = async (email, password)=>{\n    try {\n        const res = await axios({\n            method: 'POST',\n            url: '/api/v1/users/login',\n            data: {\n                email: email,\n                password: password\n            }\n        });\n        if (res.data.status === 'success') {\n            (0, $e6adfa685459127e$export$de026b00723010c1)('success', 'Logged in successfully!');\n            console.log('hey you successed');\n            window.setTimeout(()=>{\n                location.assign('/');\n            }, 1500);\n        }\n    } catch (err) {\n        (0, $e6adfa685459127e$export$de026b00723010c1)('error', err.response.data.message);\n        console.log(err);\n    }\n};\nconst $94464591c703bfdb$export$a0973bcfe11b05c9 = async ()=>{\n    try {\n        const res = await axios({\n            method: 'GET',\n            url: '/api/v1/users/logout'\n        });\n        res.data.status = 'success';\n        location.reload(true);\n    } catch (err) {\n        console.log(err.response);\n        (0, $e6adfa685459127e$export$de026b00723010c1)('error', 'Error logging out! Try again.');\n    }\n};\n\n\n/* eslint-disable */ \nconst $f9cf3b0bbad468db$export$f558026a994b6051 = async (data, type)=>{\n    try {\n        const url = type === 'password' ? '/api/v1/users/updateMyPassword' : '/api/v1/users/updateMe';\n        const res = await axios({\n            method: 'PATCH',\n            url: url,\n            data: data\n        });\n        if (res.data.status === 'success') (0, $e6adfa685459127e$export$de026b00723010c1)('success', `${type.toUpperCase()} updated successfully!`);\n    } catch (err) {\n        (0, $e6adfa685459127e$export$de026b00723010c1)('error', err.response.data.message);\n    }\n};\n\n\n/* eslint-disable */ const $0dca30195359437d$var$stripe = Stripe('pk_test_51RBxaIHJH8vBPo5TYWnLN7V5N6MHo5uImMovk6fMiVtzqUGSyVZzZTxmxSu9Jf1gZYkJsxKD2LLnaoL5CqSOTJjr00dT86MN1F');\nconst $0dca30195359437d$export$8d5bdbf26681c0c2 = async (tourId)=>{\n    try {\n        // 1) Get checkout session from API\n        const session = await axios(`/api/v1/bookings/checkout-session/${tourId}`);\n        // 2) Create checkout form + chanre credit card\n        await $0dca30195359437d$var$stripe.redirectToCheckout({\n            sessionId: session.data.session.id\n        });\n    } catch (err) {\n        console.log(err);\n        showAlert('error', err);\n    }\n};\n\n\n/* eslint-disable */ const $2f4afbc8d0e7934a$export$4c5dd147b21b9176 = (startLocation, locations)=>{\n    const [lng, lat] = startLocation.coordinates;\n    const map = L.map('map', {\n        zoomControl: false,\n        scrollWheelZoom: false\n    }).setView([\n        lat,\n        lng\n    ], 13);\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors'\n    }).addTo(map);\n    const bounds = L.latLngBounds();\n    locations.forEach((loc)=>{\n        const [lng, lat] = loc.coordinates;\n        const marker = L.marker([\n            lat,\n            lng\n        ]).addTo(map);\n        marker.bindPopup(`<p>${loc.day ? `Day ${loc.day}: ` : ''}${loc.description}</p>`, {\n            autoClose: false\n        }).openPopup();\n        bounds.extend(marker.getLatLng());\n    });\n    map.fitBounds(bounds, {\n        padding: [\n            100,\n            100\n        ]\n    });\n};\n\n\nconst $5c23961f545b6059$var$userDataForm = document.querySelector('.form-user-data');\nconst $5c23961f545b6059$var$userPasswordForm = document.querySelector('.form-user-password');\nconst $5c23961f545b6059$var$bookBtn = document.getElementById('book-tour');\nconst $5c23961f545b6059$var$mapElement = document.getElementById('map');\nif ($5c23961f545b6059$var$mapElement) {\n    const locationsData = JSON.parse($5c23961f545b6059$var$mapElement.dataset.locations);\n    const { startLocation: startLocation, locations: locations } = locationsData;\n    (0, $2f4afbc8d0e7934a$export$4c5dd147b21b9176)(startLocation, locations);\n}\nif (document.querySelector('.form--login')) document.querySelector('.form--login').addEventListener('submit', (e)=>{\n    e.preventDefault();\n    //const name = document.getElementById('name').value;\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    //updateSettings({ name, email }, 'data');\n    (0, $94464591c703bfdb$export$596d806903d1f59e)(email, password);\n});\nif (document.querySelector('.nav__el--logout')) document.querySelector('.nav__el--logout').addEventListener('click', (0, $94464591c703bfdb$export$a0973bcfe11b05c9));\nif ($5c23961f545b6059$var$userDataForm) $5c23961f545b6059$var$userDataForm.addEventListener('submit', (e)=>{\n    e.preventDefault();\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n    (0, $f9cf3b0bbad468db$export$f558026a994b6051)(form, 'data');\n});\nif ($5c23961f545b6059$var$userPasswordForm) $5c23961f545b6059$var$userPasswordForm.addEventListener('submit', async (e)=>{\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n    await (0, $f9cf3b0bbad468db$export$f558026a994b6051)({\n        passwordCurrent: passwordCurrent,\n        password: password,\n        passwordConfirm: passwordConfirm\n    }, 'password');\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n});\nif ($5c23961f545b6059$var$bookBtn) $5c23961f545b6059$var$bookBtn.addEventListener('click', (e)=>{\n    e.target.textContent = 'Processing';\n    const { tourId: tourId } = e.target.dataset;\n    (0, $0dca30195359437d$export$8d5bdbf26681c0c2)(tourId);\n});\n\n})();\n//# sourceMappingURL=start.js.map\n","/* eslint-disable */\nimport { login, logout } from './login.js'\nimport { updateSettings } from './updateSettings.js';\nimport { bookTour } from './stripe.js';\nimport { displayMap } from './map.js';\n\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookBtn = document.getElementById('book-tour');\nconst mapElement = document.getElementById('map');\n\nif (mapElement) {\n    const locationsData = JSON.parse(mapElement.dataset.locations);\n    const { startLocation, locations } = locationsData\n    displayMap(startLocation, locations);\n}\n\nif (document.querySelector('.form--login'))\n    document.querySelector('.form--login').addEventListener('submit', e => {\n        e.preventDefault();\n        //const name = document.getElementById('name').value;\n        const email = document.getElementById('email').value;\n        const password = document.getElementById('password').value\n        //updateSettings({ name, email }, 'data');\n        login(email, password)\n    });\n\nif (document.querySelector('.nav__el--logout'))\n    document.querySelector('.nav__el--logout').addEventListener('click', logout);\n\n\nif (userDataForm)\n    userDataForm.addEventListener('submit', e => {\n        e.preventDefault();\n        const form = new FormData();\n        form.append('name', document.getElementById('name').value);\n        form.append('email', document.getElementById('email').value);\n        form.append('photo', document.getElementById('photo').files[0]);\n\n        updateSettings(form, 'data');\n    });\n\nif (userPasswordForm)\n    userPasswordForm.addEventListener('submit', async e => {\n        e.preventDefault();\n        document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n        const passwordCurrent = document.getElementById('password-current').value;\n        const password = document.getElementById('password').value;\n        const passwordConfirm = document.getElementById('password-confirm').value;\n        await updateSettings(\n            { passwordCurrent, password, passwordConfirm },\n            'password'\n        );\n\n        document.querySelector('.btn--save-password').textContent = 'Save password';\n        document.getElementById('password-current').value = '';\n        document.getElementById('password').value = '';\n        document.getElementById('password-confirm').value = '';\n    });\n\nif (bookBtn)\n    bookBtn.addEventListener('click', e => {\n        e.target.textContent = 'Processing';\n        const { tourId } = e.target.dataset;\n        bookTour(tourId)\n    })","/* eslint-disable */\r\nimport { showAlert } from './alerts.js'\r\n\r\nexport const login = async (email, password) => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'POST',\r\n\t\t\turl: '/api/v1/users/login',\r\n\t\t\tdata: {\r\n\t\t\t\temail,\r\n\t\t\t\tpassword\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (res.data.status === 'success') {\r\n\t\t\tshowAlert('success', 'Logged in successfully!');\r\n\t\t\tconsole.log('hey you successed');\r\n\t\t\twindow.setTimeout(() => {\r\n\t\t\t\tlocation.assign('/');\r\n\t\t\t}, 1500);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tshowAlert('error', err.response.data.message);\r\n\t\tconsole.log(err);\r\n\t}\r\n};\r\n\r\nexport const logout = async () => {\r\n\ttry {\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'GET',\r\n\t\t\turl: '/api/v1/users/logout'\r\n\t\t});\r\n\t\tif ((res.data.status = 'success')) location.reload(true);\r\n\t} catch (err) {\r\n\t\tconsole.log(err.response);\r\n\t\tshowAlert('error', 'Error logging out! Try again.');\r\n\t}\r\n};\r\n\r\n","/* eslint-disable */\n\nconst hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","/* eslint-disable */\r\nimport { showAlert } from \"./alerts.js\";\r\n\r\nexport const updateSettings = async (data, type) => {\r\n\ttry {\r\n\t\tconst url =\r\n\t\t\ttype === 'password'\r\n\t\t\t\t? '/api/v1/users/updateMyPassword'\r\n\t\t\t\t: '/api/v1/users/updateMe';\r\n\r\n\t\tconst res = await axios({\r\n\t\t\tmethod: 'PATCH',\r\n\t\t\turl,\r\n\t\t\tdata\r\n\t\t});\r\n\r\n\t\tif (res.data.status === 'success') {\r\n\t\t\tshowAlert('success', `${type.toUpperCase()} updated successfully!`);\r\n\t\t}\r\n\t} catch (err) {\r\n\t\tshowAlert('error', err.response.data.message);\r\n\t}\r\n};\r\n\r\n","/* eslint-disable */\r\nconst stripe = Stripe('pk_test_51RBxaIHJH8vBPo5TYWnLN7V5N6MHo5uImMovk6fMiVtzqUGSyVZzZTxmxSu9Jf1gZYkJsxKD2LLnaoL5CqSOTJjr00dT86MN1F');\r\n\r\nexport const bookTour = async tourId => {\r\n\ttry {\r\n\r\n\t\t// 1) Get checkout session from API\r\n\t\tconst session = await axios(`/api/v1/bookings/checkout-session/${tourId}`)\r\n\t\t// 2) Create checkout form + chanre credit card\r\n\t\tawait stripe.redirectToCheckout({\r\n\t\t\tsessionId: session.data.session.id\r\n\t\t})\r\n\t} catch (err) {\r\n\t\tconsole.log(err);\r\n\t\tshowAlert('error', err)\r\n\t}\r\n}\r\n\r\n\r\n","/* eslint-disable */\r\nexport const displayMap = (startLocation, locations) => {\r\n\tconst [lng, lat] = startLocation.coordinates;\r\n\tconst map = L.map('map', {\r\n\t\tzoomControl: false,\r\n\t\tscrollWheelZoom: false,\r\n\t}).setView([lat, lng], 13);\r\n\r\n\tL.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n\t\tattribution: '&copy; OpenStreetMap contributors'\r\n\t}).addTo(map);\r\n\r\n\tconst bounds = L.latLngBounds();\r\n\r\n\tlocations.forEach(loc => {\r\n\t\tconst [lng, lat] = loc.coordinates;\r\n\r\n\t\tconst marker = L.marker([lat, lng]).addTo(map);\r\n\t\tmarker.bindPopup(`<p>${loc.day ? `Day ${loc.day}: ` : ''}${loc.description}</p>`, {\r\n\t\t\tautoClose: false\r\n\t\t}).openPopup();\r\n\t\tbounds.extend(marker.getLatLng());\r\n\t});\r\n\tmap.fitBounds(bounds, { padding: [100, 100] })\r\n};"],"names":["$e6adfa685459127e$var$hideAlert","el","document","querySelector","parentElement","removeChild","$e6adfa685459127e$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$94464591c703bfdb$export$596d806903d1f59e","email","password","res","axios","method","url","data","status","console","log","location","assign","err","response","message","$94464591c703bfdb$export$a0973bcfe11b05c9","reload","$f9cf3b0bbad468db$export$f558026a994b6051","toUpperCase","$0dca30195359437d$var$stripe","Stripe","$0dca30195359437d$export$8d5bdbf26681c0c2","tourId","session","redirectToCheckout","sessionId","id","showAlert","$5c23961f545b6059$var$userDataForm","$5c23961f545b6059$var$userPasswordForm","$5c23961f545b6059$var$bookBtn","getElementById","$5c23961f545b6059$var$mapElement","startLocation","locations","JSON","parse","dataset","lng","lat","coordinates","map","L","zoomControl","scrollWheelZoom","setView","tileLayer","attribution","addTo","bounds","latLngBounds","forEach","loc","marker","bindPopup","day","description","autoClose","openPopup","extend","getLatLng","fitBounds","padding","addEventListener","e","preventDefault","value","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target"],"version":3,"file":"start.js.map"}