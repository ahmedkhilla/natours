(()=>{let e=()=>{let e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},t=(t,o)=>{e();let a=`<div class="alert alert--${t}">${o}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",a),window.setTimeout(e,5e3)},o=async(e,o)=>{try{let a=await axios({method:"POST",url:"/api/v1/users/login",data:{email:e,password:o}});"success"===a.data.status&&(t("success","Logged in successfully!"),console.log("hey you successed"),window.setTimeout(()=>{location.assign("/")},1500))}catch(e){t("error",e.response.data.message),console.log(e)}},a=async()=>{try{(await axios({method:"GET",url:"/api/v1/users/logout"})).data.status="success",location.reload(!0)}catch(e){console.log(e.response),t("error","Error logging out! Try again.")}},s=async(e,o)=>{try{let a="password"===o?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe",s=await axios({method:"PATCH",url:a,data:e});"success"===s.data.status&&t("success",`${o.toUpperCase()} updated successfully!`)}catch(e){t("error",e.response.data.message)}},r=Stripe("pk_test_51RBxaIHJH8vBPo5TYWnLN7V5N6MHo5uImMovk6fMiVtzqUGSyVZzZTxmxSu9Jf1gZYkJsxKD2LLnaoL5CqSOTJjr00dT86MN1F"),n=async e=>{try{let t=await axios(`/api/v1/bookings/checkout-session/${e}`);await r.redirectToCheckout({sessionId:t.data.session.id})}catch(e){console.log(e),showAlert("error",e)}},d=document.querySelector(".form-user-data"),l=document.querySelector(".form-user-password"),u=document.getElementById("book-tour"),c=document.getElementById("map");if(c){let{startLocation:e,locations:t}=JSON.parse(c.dataset.locations);((e,t)=>{let[o,a]=e.coordinates,s=L.map("map",{zoomControl:!1,scrollWheelZoom:!1}).setView([a,o],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(s);let r=L.latLngBounds();t.forEach(e=>{let[t,o]=e.coordinates,a=L.marker([o,t]).addTo(s);a.bindPopup(`<p>${e.day?`Day ${e.day}: `:""}${e.description}</p>`,{autoClose:!1}).openPopup(),r.extend(a.getLatLng())}),s.fitBounds(r,{padding:[100,100]})})(e,t)}document.querySelector(".form--login")&&document.querySelector(".form--login").addEventListener("submit",e=>{e.preventDefault(),o(document.getElementById("email").value,document.getElementById("password").value)}),document.querySelector(".nav__el--logout")&&document.querySelector(".nav__el--logout").addEventListener("click",a),d&&d.addEventListener("submit",e=>{e.preventDefault();let t=new FormData;t.append("name",document.getElementById("name").value),t.append("email",document.getElementById("email").value),t.append("photo",document.getElementById("photo").files[0]),s(t,"data")}),l&&l.addEventListener("submit",async e=>{e.preventDefault(),document.querySelector(".btn--save-password").textContent="Updating...";let t=document.getElementById("password-current").value,o=document.getElementById("password").value,a=document.getElementById("password-confirm").value;await s({passwordCurrent:t,password:o,passwordConfirm:a},"password"),document.querySelector(".btn--save-password").textContent="Save password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value=""}),u&&u.addEventListener("click",e=>{e.target.textContent="Processing";let{tourId:t}=e.target.dataset;n(t)})})();
//# sourceMappingURL=start.js.map
